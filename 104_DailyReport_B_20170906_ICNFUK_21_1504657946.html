<!DOCTYPE html><html><head><title>Daily Report From online scraping</title><meta charset="utf-8"><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script><script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.9/angular-route.js"></script><script src="http://d3js.org/d3.v4.min.js"></script><script type="text/javascript" charset="utf8" src="http://cdn.datatables.net/1.10.15/js/jquery.dataTables.js"></script><link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/1.10.15/css/jquery.dataTables.css"><style type="text/css">	tfoot input{		width: 100%;		padding: 3px;		box-sizing: border-box;	}	.tick line {		fill: none;		stroke: lightgray;		stroke-dasharray: 5 5	}	path.domain{		display: none;	}</style></head><body><h2>daily report</h2><!--title--><div id="controls"></div><div id="chart"></div><div><table id="table_id" class="display">    <thead><tr><th>dpt_date</th><th>dpt</th><th>arr</th><th>flt</th><th>dpt_time</th><th>fare</th><th>TW-info</th><th>TW-fare</th><th>LJ-info</th><th>LJ-fare</th><th>7C-info</th><th>7C-fare</th></tr></thead><!--<tr><th>column1</th><th>...</tr>-->    <tfoot><tr><th>dpt_date</th><th>dpt</th><th>arr</th><th>flt</th><th>dpt_time</th><th>fare</th><th>TW-info</th><th>TW-fare</th><th>LJ-info</th><th>LJ-fare</th><th>7C-info</th><th>7C-fare</th></tr></tfoot>    <tbody><tr><td>2017-09-07</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td></td><td>0.0</td><td></td><td>0.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-07</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>69000.0</td><td></td><td>0.0</td><td></td><td>0.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-08</td><td>ICN</td><td>FUK</td><td>0643</td><td>07:25</td><td>79000.0</td><td></td><td>0.0</td><td>LJ-0221-0705</td><td>94000.0</td><td>7C-1402-0935</td><td>105000.0</td></tr><tr><td>2017-09-09</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>59000.0</td><td>TW-8291-1440</td><td>70000.0</td><td>LJ-0227-1555</td><td>66000.0</td><td></td><td>0.0</td></tr><tr><td>2017-09-09</td><td>ICN</td><td>FUK</td><td>0643</td><td>07:55</td><td>119000.0</td><td>TW-0291-1005</td><td>100000.0</td><td>LJ-0221-0705</td><td>110000.0</td><td></td><td>0.0</td></tr><tr><td>2017-09-09</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>99000.0</td><td>TW-0291-1005</td><td>100000.0</td><td>LJ-0223-1200</td><td>160000.0</td><td></td><td>0.0</td></tr><tr><td>2017-09-10</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>59000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1615</td><td>55000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-10</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>79000.0</td><td>TW-0291-1005</td><td>60000.0</td><td>LJ-0221-0715</td><td>66000.0</td><td>7C-1402-0935</td><td>120000.0</td></tr><tr><td>2017-09-11</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1520</td><td>50000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-11</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>59000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0221-0715</td><td>50000.0</td><td>7C-1402-0935</td><td>95000.0</td></tr><tr><td>2017-09-11</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>69000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0223-1200</td><td>94000.0</td><td>7C-1402-0935</td><td>95000.0</td></tr><tr><td>2017-09-12</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1555</td><td>50000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-12</td><td>ICN</td><td>FUK</td><td>0643</td><td>07:55</td><td>49000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0221-0715</td><td>50000.0</td><td>7C-1402-0935</td><td>75000.0</td></tr><tr><td>2017-09-13</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td>TW-8291-1440</td><td>40000.0</td><td>LJ-0227-1555</td><td>50000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-13</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>49000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0223-1200</td><td>55000.0</td><td>7C-1402-0935</td><td>85000.0</td></tr><tr><td>2017-09-13</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>69000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0223-1200</td><td>55000.0</td><td>7C-1402-0935</td><td>85000.0</td></tr><tr><td>2017-09-14</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>59000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1555</td><td>50000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-14</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>69000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0221-0715</td><td>50000.0</td><td>7C-1402-0935</td><td>85000.0</td></tr><tr><td>2017-09-15</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>79000.0</td><td>TW-8291-1440</td><td>70000.0</td><td>LJ-0221-0705</td><td>66000.0</td><td>7C-1404-1530</td><td>85000.0</td></tr><tr><td>2017-09-15</td><td>ICN</td><td>FUK</td><td>0643</td><td>07:25</td><td>99000.0</td><td>TW-0291-1005</td><td>90000.0</td><td>LJ-0221-0705</td><td>66000.0</td><td>7C-1402-0935</td><td>180000.0</td></tr><tr><td>2017-09-16</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>99000.0</td><td>TW-8291-1440</td><td>80000.0</td><td>LJ-0227-1555</td><td>66000.0</td><td>7C-1404-1530</td><td>85000.0</td></tr><tr><td>2017-09-16</td><td>ICN</td><td>FUK</td><td>0643</td><td>07:55</td><td>99000.0</td><td>TW-0291-1005</td><td>120000.0</td><td>LJ-0221-0705</td><td>94000.0</td><td>7C-1402-0935</td><td>145000.0</td></tr><tr><td>2017-09-16</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>99000.0</td><td>TW-0291-1005</td><td>120000.0</td><td>LJ-0223-1200</td><td>94000.0</td><td>7C-1402-0935</td><td>145000.0</td></tr><tr><td>2017-09-17</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>69000.0</td><td>TW-8291-1440</td><td>60000.0</td><td>LJ-0227-1615</td><td>55000.0</td><td>7C-1404-1530</td><td>85000.0</td></tr><tr><td>2017-09-17</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>69000.0</td><td>TW-0291-1005</td><td>70000.0</td><td>LJ-0221-0715</td><td>55000.0</td><td>7C-1404-1530</td><td>85000.0</td></tr><tr><td>2017-09-18</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>59000.0</td><td>TW-0291-1005</td><td>70000.0</td><td>LJ-0221-0715</td><td>55000.0</td><td>7C-1402-0935</td><td>105000.0</td></tr><tr><td>2017-09-18</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>79000.0</td><td>TW-0291-1005</td><td>70000.0</td><td>LJ-0223-1200</td><td>66000.0</td><td>7C-1402-0935</td><td>105000.0</td></tr><tr><td>2017-09-19</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1555</td><td>50000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-19</td><td>ICN</td><td>FUK</td><td>0643</td><td>07:55</td><td>49000.0</td><td>TW-0291-1005</td><td>70000.0</td><td>LJ-0221-0715</td><td>50000.0</td><td>7C-1402-0935</td><td>85000.0</td></tr><tr><td>2017-09-20</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td>TW-8291-1440</td><td>40000.0</td><td>LJ-0227-1555</td><td>50000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-20</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>49000.0</td><td>TW-0291-1005</td><td>60000.0</td><td>LJ-0221-0715</td><td>66000.0</td><td>7C-1402-0935</td><td>85000.0</td></tr><tr><td>2017-09-20</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>59000.0</td><td>TW-0291-1005</td><td>60000.0</td><td>LJ-0221-0715</td><td>66000.0</td><td>7C-1402-0935</td><td>85000.0</td></tr><tr><td>2017-09-21</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1555</td><td>55000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-21</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>59000.0</td><td>TW-0291-1005</td><td>60000.0</td><td>LJ-0221-0715</td><td>50000.0</td><td>7C-1402-0935</td><td>95000.0</td></tr><tr><td>2017-09-21</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>59000.0</td><td>TW-0291-1005</td><td>60000.0</td><td>LJ-0223-1200</td><td>66000.0</td><td>7C-1402-0935</td><td>95000.0</td></tr><tr><td>2017-09-22</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>79000.0</td><td>TW-8291-1440</td><td>80000.0</td><td>LJ-0227-1435</td><td>83000.0</td><td>7C-1404-1530</td><td>85000.0</td></tr><tr><td>2017-09-22</td><td>ICN</td><td>FUK</td><td>0643</td><td>07:25</td><td>99000.0</td><td>TW-0291-1005</td><td>90000.0</td><td>LJ-0221-0705</td><td>83000.0</td><td>7C-1402-0935</td><td>85000.0</td></tr><tr><td>2017-09-22</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>99000.0</td><td>TW-0291-1005</td><td>90000.0</td><td>LJ-0223-1200</td><td>94000.0</td><td>7C-1402-0935</td><td>85000.0</td></tr><tr><td>2017-09-23</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>79000.0</td><td>TW-8291-1440</td><td>80000.0</td><td>LJ-0227-1555</td><td>83000.0</td><td>7C-1404-1530</td><td>85000.0</td></tr><tr><td>2017-09-24</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>69000.0</td><td>TW-0293-1800</td><td>100000.0</td><td>LJ-0227-1615</td><td>66000.0</td><td>7C-1404-1530</td><td>105000.0</td></tr><tr><td>2017-09-24</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>99000.0</td><td>TW-0291-1005</td><td>70000.0</td><td>LJ-0221-0715</td><td>83000.0</td><td>7C-1402-0935</td><td>95000.0</td></tr><tr><td>2017-09-24</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>69000.0</td><td>TW-0291-1005</td><td>70000.0</td><td>LJ-0223-1200</td><td>94000.0</td><td>7C-1402-0935</td><td>95000.0</td></tr><tr><td>2017-09-25</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>59000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1520</td><td>55000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-25</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>69000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0221-0715</td><td>55000.0</td><td>7C-1402-0935</td><td>65000.0</td></tr><tr><td>2017-09-25</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>59000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0223-1200</td><td>66000.0</td><td>7C-1402-0935</td><td>65000.0</td></tr><tr><td>2017-09-26</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1555</td><td>50000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-26</td><td>ICN</td><td>FUK</td><td>0643</td><td>07:55</td><td>49000.0</td><td>TW-0291-1005</td><td>60000.0</td><td>LJ-0221-0715</td><td>50000.0</td><td>7C-1402-0935</td><td>75000.0</td></tr><tr><td>2017-09-26</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>49000.0</td><td>TW-0291-1005</td><td>60000.0</td><td>LJ-0223-1200</td><td>50000.0</td><td>7C-1402-0935</td><td>75000.0</td></tr><tr><td>2017-09-27</td><td>ICN</td><td>FUK</td><td>0641</td><td>14:40</td><td>49000.0</td><td>TW-8291-1440</td><td>50000.0</td><td>LJ-0227-1555</td><td>50000.0</td><td>7C-1404-1530</td><td>65000.0</td></tr><tr><td>2017-09-27</td><td>ICN</td><td>FUK</td><td>0643</td><td>08:40</td><td>49000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0221-0715</td><td>50000.0</td><td>7C-1402-0935</td><td>65000.0</td></tr><tr><td>2017-09-27</td><td>ICN</td><td>FUK</td><td>9641</td><td>10:05</td><td>49000.0</td><td>TW-0291-1005</td><td>50000.0</td><td>LJ-0223-1200</td><td>55000.0</td><td>7C-1402-0935</td><td>65000.0</td></tr></tbody><!--<tr><td>data1</td><td>...</tr>--></table></div><script type="text/javascript">/*로드 팩터 처리용 데이터*/var lf_datas = [['641', 'ICN', 'FUK', '2017-09-11', '49'], ['641', 'ICN', 'FUK', '2017-09-12', '32'], ['641', 'ICN', 'FUK', '2017-09-13', '30'], ['641', 'ICN', 'FUK', '2017-09-19', '49'], ['641', 'ICN', 'FUK', '2017-09-20', '31'], ['641', 'ICN', 'FUK', '2017-09-21', '32'], ['641', 'ICN', 'FUK', '2017-09-26', '20'], ['641', 'ICN', 'FUK', '2017-09-27', '19'], ['641', 'ICN', 'FUK', '2017-10-06', '36'], ['642', 'FUK', 'ICN', '2017-09-29', '41'], ['642', 'FUK', 'ICN', '2017-09-30', '30'], ['642', 'FUK', 'ICN', '2017-10-01', '32'], ['642', 'FUK', 'ICN', '2017-10-02', '47'], ['643', 'ICN', 'FUK', '2017-09-12', '42'], ['643', 'ICN', 'FUK', '2017-09-26', '49'], ['644', 'FUK', 'ICN', '2017-09-11', '47'], ['644', 'FUK', 'ICN', '2017-09-12', '43'], ['644', 'FUK', 'ICN', '2017-09-13', '46'], ['644', 'FUK', 'ICN', '2017-09-14', '33'], ['644', 'FUK', 'ICN', '2017-09-18', '42'], ['644', 'FUK', 'ICN', '2017-09-19', '41'], ['644', 'FUK', 'ICN', '2017-09-20', '32'], ['644', 'FUK', 'ICN', '2017-09-21', '49'], ['644', 'FUK', 'ICN', '2017-09-26', '47'], ['644', 'FUK', 'ICN', '2017-09-27', '39'], ['644', 'FUK', 'ICN', '2017-09-29', '42'], ['644', 'FUK', 'ICN', '2017-09-30', '42'], ['644', 'FUK', 'ICN', '2017-10-01', '17'], ['644', 'FUK', 'ICN', '2017-10-02', '41'], ['9641', 'ICN', 'FUK', '2017-09-26', '25'], ['9641', 'ICN', 'FUK', '2017-09-27', '25'], ['9641', 'ICN', 'FUK', '2017-09-28', '50'], ['9642', 'FUK', 'ICN', '2017-09-12', '42'], ['9642', 'FUK', 'ICN', '2017-09-21', '47'], ['9642', 'FUK', 'ICN', '2017-09-27', '22'], ['9642', 'FUK', 'ICN', '2017-09-28', '25'], ['9642', 'FUK', 'ICN', '2017-09-29', '40'], ['9642', 'FUK', 'ICN', '2017-09-30', '42'], ['9642', 'FUK', 'ICN', '2017-10-01', '25'], ['9642', 'FUK', 'ICN', '2017-10-02', '27']];var svg = null;var table_header = [];var chart_header = [];var chart_onoff = [];var table_data = [];var parseTime = d3.timeParse("%Y-%m-%d %H:%M");var parseDate = d3.timeParse("%Y-%m-%d");$(document).ready(function() {	$("#table_id tfoot th").each( function () {		var title = $(this).text();		$(this).html( "<input type='text' placeholder='Search "+title+"' />" );  } );		var table = $("#table_id").DataTable();		table.columns().every( function () {			var that = this;    $( "input", this.footer() ).on( "keyup change", function () {				if ( that.search() !== this.value ) {					that.search( this.value ).draw(); 				}			});		});		/*테이블 헤더 생성*/		table.columns().header().each(function(value){			table_header.push(value.innerText);			if(value.innerText.indexOf("fare") >= 0){				chart_header.push(value.innerText);				chart_onoff.push(true);				}			});		/* 테이블 데이터 생성 */		table.rows().nodes().each(function(value,i,api){			var row_data = [];			for(var i = 0 , len = value.cells.length ; i < len ; i++){				row_data.push(value.cells[i].innerText);			}			table_data.push(row_data);  });  draw_controls();});/*select box, button*/function draw_controls(){	var flt_set = new Set();	for(var i = 0, len = table_data.length ; i < len ; i++){		flt_set.add(table_data[i][3]);	}	var flt_list = [];	flt_set.forEach(function(d){		flt_list.push(d);	});	d3.select("#controls").append("b").html("select flight number and push chart button : ");	var flt_options = d3.select("#controls").append("select").attr("name","flt_options");	flt_options.selectAll("option").data(flt_list).enter().append("option")		.attr("value",function(d){return d;}).html(function(d){return d;});	d3.select("#controls").append("button").html("line chart").on("click",draw_chart);	d3.select("#controls").append("button").html("calendar chart").on("click",draw_calendar);	return flt_list;}function draw_chart(){	var selected_option = d3.select("#controls select").selectAll("option").nodes().filter(function(d){ return d.selected;});	var selected_data = [];	for(var i = 0, len = table_data.length; i < len; i ++){		if(table_data[i][3] == selected_option[0].value){			/*경쟁사 숫자 조정시 고려한 처리로 변경*/ 			var selected_list = [table_data[i][0],table_data[i][5]];/*ZE*/			/*other airline*/			for(var j = 6, header_len = table_header.length; j < header_len ; j++){				if(table_header[j].indexOf("fare") >= 0){					selected_list.push(table_data[i][j]);				}			}			selected_data.push(selected_list);		}	}	var w = 1200, h = 500, pad = 40;	svg = init_draw("#chart",w,h);	var x_extent = d3.extent(selected_data,function(d){return parseDate(d[0]);});	var x_range = [pad,w-pad];	var x_scale = d3.scaleTime();	x_scale.domain(x_extent).range(x_range);	var y_maxes = [];	y_maxes.push(d3.max(table_data,function(d){return parseInt(d[5]);}));	for(var i = 0, header_len = (table_header.length-6)/2; i < header_len;i++){		y_maxes.push(d3.max(table_data,function(d){return parseInt(d[7+2*i]);}));	}	var y_extent = [0,d3.max(y_maxes)+10000];	var y_range = [h-pad,pad];	var y_scale = linear_scale(y_extent,y_range);	/*linear_axis(x_extent,x_range,4,pad);*/	linear_axis(y_extent,y_range,2,pad); 	var x_axis = d3.axisBottom();	x_axis.scale(x_scale).tickSize(-(h - 2*pad));	svg.append("g").attr("id","x_axis")	 	.attr("transform","translate(0,"+(h-pad)+")").call(x_axis);	/*경쟁사 숫자 조정시 고려한 처리로 변경*/	for(var i = 0, len=chart_header.length; i < len;i++){		var chart_data = [];		for(var j = 0, sel_len=selected_data.length; j < sel_len ; j++){			chart_data.push({x:x_scale(parseDate(selected_data[j][0])),				y:y_scale(parseInt(selected_data[j][1+i].replace(",",""))),				r:5,fare:selected_data[j][1+i],date:selected_data[j][0]});		}		if(chart_onoff[i]){			draw_line(chart_header[i],chart_data,d3.schemeCategory10[i],2);			draw_circle("_"+chart_header[i],chart_data,d3.schemeCategory10[i]);		}		svg.append("text").attr("x",100+80*i).attr("y",20).attr("stroke",d3.schemeCategory10[i]).text(chart_header[i])			.attr("cursor","pointer")			.on("click",function(d){/*헤더 클릭시 차트 on off 기능 추가*/				var click_head = d3.select(this).html();				var onoff_i = chart_header.indexOf(click_head);				chart_onoff[onoff_i] = !chart_onoff[onoff_i];				draw_chart();			});	}	/*탑승률 60% 이하 해당 편의 날짜 부분 표시 */	var lf_60_data = [];	for(var i = 0, len=lf_datas.length;i < len;i++){		if(lf_datas[i][0] == selected_option[0].value && lf_datas[i][1] == table_data[0][1]){			lf_60_data.push([lf_datas[i][3],lf_datas[i][4]]);		}	}	var lf_chart_data = [];	for(var i = 0, len=lf_60_data.length; i<len; i++){		for(var j = 0, sel_len=selected_data.length; j < sel_len ; j++){			if(lf_60_data[i][0] == selected_data[j][0]){				lf_chart_data.push({x:x_scale(parseDate(lf_60_data[i][0])),					y:h-pad+17,					r:10,fare:lf_60_data[i][1]+"%",date:lf_60_data[i][0]});			}		}	}	draw_circle("loadfact_60",lf_chart_data,"yellow");	svg.selectAll("loadfact_text").data(lf_chart_data).enter()		.append("text").attr("x",function(d){			return d.x;		}).attr("y",h-pad+20).attr("font-size","8")		.attr("font-weight","bold")		.attr("text-anchor","middle")		.attr("stroke","red").text(function(d){			return "!";		});	return selected_data;}function draw_calendar(){	var selected_option = d3.select("#controls select").selectAll("option").nodes().filter(function(d){ return d.selected;});	var selected_data = [];	for(var i = 0, len = table_data.length; i < len; i ++){		if(table_data[i][3] == selected_option[0].value){			/*경쟁사 숫자 조정시 고려한 처리로 변경*/ 			var selected_list = [table_data[i][0],table_data[i][5]];/*ZE*/			/*other airline*/			for(var j = 6, henader_len = table_header.length; j < henader_len ; j++){				if(table_header[j].indexOf("fare") >= 0){					selected_list.push(table_data[i][j]);				}			}			selected_data.push(selected_list);		}	}	var w = 1400;	var h = 600;	var pad = 30;	var box_h = 36;	svg = init_draw("#chart",w,h);	var x_scale = linear_scale([0,7],[pad,w-2*pad]);	var x_axis = d3.axisTop(x_scale)		.tickSize(-(h-2*pad)).ticks(7);	var y_scale = linear_scale([1,5],[pad,h-pad]);	var y_axis =  d3.axisLeft(y_scale).tickSize(-(w-3*pad)).ticks(5);	/*x,y 축 그리기*/	svg.append("g").attr("class", "x_axis")		.attr("transform", "translate(0," + pad + ")").call(x_axis);	svg.append("g").attr("id","y_axis")		.attr("transform","translate("+pad+","+0+")").call(y_axis);	/*요일 표시*/	var day_txt = ["일","월","화","수","목","금","토"];	var i = 0;	day_txt.forEach(function(d){		draw_text(svg.append("g"),(x_scale(i)+x_scale(i+1))/2,15,d,size=12);		i++;	});	/*헤더 표시*/	i=0;	chart_header.forEach(function(d){		svg.append("g").append("text").attr("class","head_text")		.attr("x",w-1.7*pad).attr("y",pad*2+20*i)		.attr("font-size",12)		.attr("font-weight","bold")		.attr("fill",d3.schemeCategory10[i])		.text(d);		i++;	});	/* 각 박스에 바차트를 그려준다. 한칸을 기준으로 가격 스케일 작성*/	var f_extent = [d3.min(selected_data,function(d){		var sf_list = [];		d.slice(1,d.length).forEach(function(d){			sf_list.push(parseInt(d));		});		return d3.min(sf_list);	}),d3.max(selected_data,function(d){		var sf_list = [];		d.slice(1,d.length).forEach(function(d){			sf_list.push(parseInt(d));		});		return d3.max(sf_list);	})];	var f_range = [0,x_scale(1)-x_scale(0)-20];	var f_scale = linear_scale(f_extent,f_range);	/*각 칸의 여백 조정*/	var cw_pad = (x_scale(1) - x_scale(0))/2;	var ch_pad = (y_scale(1)-y_scale(0))/2;	/*박스 위치 체크를 위한 날짜*/	var start_date = d3.min(selected_data,function(d){		return d[0];	});	selected_data.forEach(function(d){		var day_week = get_day_week(start_date,d[0]);		for(var i = 1, len=d.length;i<len;i++){			draw_box(svg,"fare",{				x: x_scale(day_week[0]),				y: y_scale(day_week[1] -1+ i/len),				width: f_scale(d[i]),				height:18,				color:d3.schemeCategory10[i-1],				info:d[i]			});			/*가격 표시*/			draw_text(svg,x_scale(day_week[0])+3,				y_scale(day_week[1] -1+ i/len)+3,d[i],size=13);			/*날짜 표시*/			draw_text(svg,x_scale(day_week[0])+cw_pad*1.8,				y_scale(day_week[1] )-ch_pad*1.7,parseDate(d[0]).getDate(),size=12);		}	});	/*탑승률 60% 이하 해당 편의 날짜 부분 표시 */	var lf_60_data = [];	for(var i = 0, len=lf_datas.length;i < len;i++){		if(lf_datas[i][0] == selected_option[0].value && lf_datas[i][1] == table_data[0][1]){			lf_60_data.push([lf_datas[i][3],lf_datas[i][4]]);		}	}	var lf_chart_data = [];	for(var i = 0, len=lf_60_data.length; i<len; i++){		for(var j = 0, sel_len=selected_data.length; j < sel_len ; j++){			if(lf_60_data[i][0] == selected_data[j][0]){				var day_week = get_day_week(start_date,lf_60_data[i][0]);				lf_chart_data.push({x:x_scale(day_week[0])+cw_pad,y:y_scale(day_week[1])-ch_pad,					r:ch_pad,fare:lf_60_data[i][1]+"%",date:lf_60_data[i][0]});			}		}	}	/*draw_circle("loadfact_60",lf_chart_data,"yellow");*/	svg.selectAll("loadfact_text").data(lf_chart_data).enter()		.append("text").attr("x",function(d){return d.x+cw_pad*0.5;})		.attr("y",function(d){ return d.y-ch_pad*0.3;}).attr("font-size","20")		.attr("font-weight","bold")		.attr("text-anchor","middle")		.attr("stroke","red").text(function(d){			return d.fare;		});	return selected_data;}/* width, height 로 svg canvas 초기화 */function init_draw(parent,w,h){	d3.select(parent).select("svg").remove();	return d3.select(parent).append("svg").attr("width",w).attr("height",h);}/* x,y 값 형태의 데이터를 받앙 color로 line plot */function draw_line(cname,cdata,ccolor,cwidth){	var cline = d3.line().curve(d3.curveMonotoneX)		.x(function(d){ return d.x; }).y(function(d){ return d.y; });	svg.append("g").append("path")		.attr("class", cname+"_line").attr("d", cline(cdata))		.attr("stroke",ccolor).attr("stroke-width",cwidth).attr("fill","none");}/* r,x,y 값 형태의 데이터를 받아 color 로 circle plot*/var selected_line = null;function draw_circle(cname,cdata,ccolor){	svg.append("g").selectAll(cname).data(cdata).enter()		.append("circle").attr("class",cname+"_circle")		.attr("r",function(d){ return d.r;})		.attr("cx",function(d){return d.x;})		.attr("cy",function(d){return d.y;})		.attr("fill",ccolor)		.attr("opacity",0.6)		.append("title").text(function(d){			return "("+d.date+","+d.fare+")";		})		.on("mouseover",function(d){			selected_line = this;		});}/* x,y,width,height 값 형태의 데이터를 box plot*/function draw_box(p_obj,cname,cdata){	var box_g = p_obj.append("g").attr("class","box")		.attr("transform", "translate("+cdata.x+","+cdata.y+")");	box_g.append("rect").attr("id",cname+"_rect").attr("class","range")		.attr("width",cdata.width).attr("height",cdata.height)		.attr("y",-cdata.height/2)		.attr("info",cdata.info)		.attr("fill",cdata.color)		.attr("opacity",0.7);	return box_g;}function draw_text(p_obj,x,y,text,size=10,color="black"){	return p_obj.append("text").attr("class","axis_text")		.attr("x",x).attr("y",y).attr("font-size",size)		.attr("fill",color).text(text);}function get_day_week(s,d) {	var ddate = parseDate(d);	var sdate = parseDate(s);	/*비교 대상 일을 가장 작은 날짜를 기준으로 변경 필요??*/	/*var djan = new Date(sdate.getFullYear(),sdate.getMonth(),1);*/	var djan = new Date(sdate.getFullYear(),sdate.getMonth(),sdate.getDate() - sdate.getDay() - 1);	return [ddate.getDay(),Math.ceil((((ddate - djan) / 86400000) + djan.getDay()+1)/7)];}	/* domain extent와 range extent를 이용하여 linear scale 생성 */function linear_scale(d_extent,r_extent){	return d3.scaleLinear().domain(d_extent).range(r_extent);}/* domain extent와 range extent, direction를 이용하여  축 생성 *//* direction : 1/2/3/4 - left,right,top,bottom *//* axis position : x, y */function linear_axis(d_extent,r_extent,dir,pad){	var ls = d3.scaleLinear().domain(d_extent).range(r_extent);	var axis = null, axis_id = null;	var svg_w = parseInt(svg.attr("width"));	var svg_h = parseInt(svg.attr("height"));	var x = 0,y=0, tick_size = 0;	if(dir == 1){		axis = d3.axisLeft();		axis_id = "x_axis";		x = pad;		tick_size = -(svg_w - 2*pad);	 }else if(dir == 2){	 	axis = d3.axisRight();	 	axis_id = "x_axis";	 	x = svg_w-pad;	 	tick_size = -(svg_w - 2*pad);	 }else if(dir == 3){	 	axis = d3.axisTop();	 	axis_id = "y_axis";	 	y = pad;	 	tick_size = -(svg_h - 2*pad);	 }else if(dir == 4){	 	axis = d3.axisBottom();	 	axis_id = "y_axis";	 	y = svg_h-pad;	 	tick_size = -(svg_h - 2*pad);	 }else{	 	axis = d3.axisBottom();	 	axis_id = "x_axis";	 	y = svg_h-pad;	 	tick_size = -(svg_h - 2*pad);	 }	 axis.scale(ls).tickSize(tick_size);	 svg.append("g").attr("id",axis_id)	 	.attr("transform","translate("+x+","+y+")").call(axis);	 return axis;}</script></body></html>